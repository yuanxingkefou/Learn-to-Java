#类文件结构

Class文件格式采用一种类似于C语言结构体的伪结构来存储数据，这种伪结构只有两种数据类型：无符号数和表

无符号数：基本的数据类型，以u1，u2,u4,u8来分别代表1，2，4，8个字节的无符号数；可以用来描述数字，索引引用，数量值或者字符串值

表是由多个无符号数或者其他表作为数据项构成的复合数据类型，习惯性地以“_info”结尾；用于描述有层次关系的复合结构的数据

1.**魔数**：每个Class文件的头4个字节称为魔数，它的唯一作用是确定这个字节是否为一个能被虚拟机接受的Class文件，值为“0xCAFEBABE”

2.在魔数后存储的是Class文件的版本号：第5和第6个字节是次版本号，第7和第8个字节是主版本号

3.版本号之后的是**常量池(Constant_pool)**入口：入口需放置一项u2类型的数据，代表常量池容量计数值（容量计数值从1开始，而不是0）

常量池主要存放两大类常量：字面量（literal）和符号引用（Symbolic References）；常量池中每一项常量都是一个表，表开始的第一位是一个u1类型的标志位
，代表这个常量属于哪种常量类型

![image]()

4.常量池结束后，紧接着的两个字节代表访问标志，用于识别一些类或者接口层次的访问信息。包括：这个Class是类还是接口，是否为public类型，是否为abstract类型
是否声明为final等

5.访问标志之后是类索引，父类索引和接口索引集合按顺序排列；类索引和父类索引是一个u2类型的数据，接口索引集合是一组u2类型的数据的集合

6.之后是**字段表(field_info)**：用于描述接口或者类中声明的变量（包括类级变量和实例变量，不包括在方法内部的局部变量），第一个u2类型的数据为容量计数器

![image]()

7.之后是**方法表集合**,和字段表集合几乎完全一致，方法里的代码，经过编译器编译成字节码指令后，存放在方法属性表集合中一个名为“Code”的属性里。可能会出现由
编译器自动添加的方法，如类构造器“<clinit>"方法和实例构造器"<init>"方法

**属性表集合（attribute info）**

![image]()

**##字节码指令**







